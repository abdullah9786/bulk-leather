# üìÖ Google Calendar API Setup - Automatic Meeting Scheduling

## üéØ **What This Enables**

When users schedule a Google Meet video call:
- ‚úÖ **Automatic calendar event creation** for both user and admin
- ‚úÖ **Google Meet link auto-generated** by Google
- ‚úÖ **Email invitations sent automatically** by Google Calendar
- ‚úÖ **Reminders sent** (1 day, 1 hour, 15 min before)
- ‚úÖ **Calendar notifications** to both parties
- ‚úÖ **No manual work** - completely automated!

---

## üöÄ **Setup Guide (15 minutes)**

### **Step 1: Enable Google Calendar API**

1. Go to: https://console.cloud.google.com/
2. Select your project ("BulkLeather")
3. Go to **"APIs & Services" ‚Üí "Library"**
4. Search for **"Google Calendar API"**
5. Click it and click **"Enable"**
6. Wait for activation

---

### **Step 2: Create Service Account**

1. Go to **"APIs & Services" ‚Üí "Credentials"**
2. Click **"Create Credentials" ‚Üí "Service Account"**
3. **Service account details:**
   - Name: `bulkleather-calendar`
   - ID: `bulkleather-calendar` (auto-filled)
   - Description: "Service account for calendar event creation"
4. Click **"Create and Continue"**
5. **Grant permissions:**
   - Role: **"Editor"** (or "Owner")
   - Click **"Continue"**
6. Click **"Done"**

---

### **Step 3: Create Service Account Key**

1. Click on the service account you just created
2. Go to **"Keys"** tab
3. Click **"Add Key" ‚Üí "Create new key"**
4. Choose **"JSON"**
5. Click **"Create"**
6. **JSON file downloads automatically** - Save it safely!

---

### **Step 4: Extract Credentials from JSON**

Open the downloaded JSON file. It looks like:

```json
{
  "type": "service_account",
  "project_id": "your-project",
  "private_key_id": "...",
  "private_key": "-----BEGIN PRIVATE KEY-----\nMIIE...\n-----END PRIVATE KEY-----\n",
  "client_email": "bulkleather-calendar@your-project.iam.gserviceaccount.com",
  "client_id": "...",
  ...
}
```

**Extract these two values:**
1. `client_email` ‚Üí This is your service account email
2. `private_key` ‚Üí This is your private key (entire value including BEGIN/END)

---

### **Step 5: Share Calendar with Service Account**

1. Open **Google Calendar**: https://calendar.google.com/
2. **Settings** (gear icon) ‚Üí **Settings**
3. Scroll to **"Settings for my calendars"**
4. Click your calendar (usually your email)
5. Scroll to **"Share with specific people or groups"**
6. Click **"+ Add people and groups"**
7. **Paste service account email:**
   ```
   bulkleather-calendar@your-project.iam.gserviceaccount.com
   ```
8. **Permission:** Choose **"Make changes to events"**
9. Click **"Send"**
10. Click **"OK"** on confirmation

**Important:** This allows the service account to create events in YOUR calendar!

**Note:** We create events on the admin calendar only (not customer's calendar) to avoid needing Domain-Wide Delegation. The Meet link is shared with customers via email/SMS.

---

### **Step 6: Add to .env.local**

Add these to your `.env.local`:

```env
# Google Calendar API - Service Account
GOOGLE_SERVICE_ACCOUNT_EMAIL=bulkleather-calendar@your-project.iam.gserviceaccount.com
GOOGLE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nYourActualPrivateKey\n-----END PRIVATE KEY-----\n"
GOOGLE_CALENDAR_ID=your-email@gmail.com
ADMIN_CALENDAR_EMAIL=admin-email@bulkleather.com
```

**Important Notes:**
- Keep the private key in quotes
- Include the `\n` characters (they're literal)
- Or use single line with actual newlines preserved
- `GOOGLE_CALENDAR_ID` is the calendar to create events in (usually your email)
- `ADMIN_CALENDAR_EMAIL` is who will receive meeting invites

**Example:**
```env
GOOGLE_SERVICE_ACCOUNT_EMAIL=bulkleather-calendar@bulkleather-123456.iam.gserviceaccount.com
GOOGLE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC...\n-----END PRIVATE KEY-----\n"
GOOGLE_CALENDAR_ID=youremail@gmail.com
ADMIN_CALENDAR_EMAIL=sales@bulkleather.com
```

---

### **Step 7: Install Dependencies**

```bash
npm install
```

This installs `googleapis` package.

---

### **Step 8: Restart Server**

```bash
# Stop server (Ctrl+C)
npm run dev
```

---

### **Step 9: Test It!**

1. Go to your site
2. Click "Schedule Meeting"
3. Select **"Google Meet"**
4. Fill details
5. Submit

**What Happens:**
- ‚úÖ Calendar event created in Google Calendar
- ‚úÖ Google Meet link generated by Google
- ‚úÖ **Email sent to user automatically** by Google
- ‚úÖ **Email sent to admin** by Google
- ‚úÖ Both can see event in their calendars
- ‚úÖ Meet link included in email
- ‚úÖ Reminders set up automatically

---

## üìß **Automatic Emails from Google**

When event is created, Google automatically sends:

**To User:**
```
Subject: Invitation: Product Meeting - Company Name @ Date Time

You've been invited to:
Product Meeting - Company Name

When: [Date] at [Time]
Where: Google Meet
        https://meet.google.com/abc-defg-hij

Join with Google Meet
[Join Meeting]

Calendar: BulkLeather Sales Team
```

**To Admin (You):**
```
Same invitation email
+ Shows on your Google Calendar
+ Reminders before meeting
```

**Both parties get:**
- Calendar invitation
- Email notification
- Automatic reminders (1 day, 1 hour, 15 min before)
- Meet link to join

---

## üîß **Alternative: Simpler Setup (Without Full API)**

If you don't want to set up service account, the system will use fallback mode:

**Fallback Mode:**
- ‚úÖ Generates Meet-style links
- ‚úÖ Shows link to user
- ‚ùå Doesn't create actual calendar events
- ‚ùå No automatic Google emails
- ‚úÖ You can manually send emails with the link

**To use fallback:** Just don't set the service account variables.

---

## ‚öôÔ∏è **Environment Variables Summary**

**Required for full automation:**
```env
# Service Account (from JSON file)
GOOGLE_SERVICE_ACCOUNT_EMAIL=service-account@project.iam.gserviceaccount.com
GOOGLE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"

# Calendar Configuration
GOOGLE_CALENDAR_ID=your-email@gmail.com
ADMIN_CALENDAR_EMAIL=sales@bulkleather.com
```

**Optional (if skipped, uses fallback):**
- System still works
- Just won't send automatic Google emails
- Links will be simulated

---

## üéØ **Benefits of Full Setup**

### **With Google Calendar API:**
- ‚úÖ Real Google Meet links (from Google)
- ‚úÖ Automatic email invitations
- ‚úÖ Events in both calendars
- ‚úÖ Automatic reminders
- ‚úÖ Professional appearance
- ‚úÖ Less manual work
- ‚úÖ Better user experience

### **Without API (Fallback):**
- ‚úÖ Meet-style links generated
- ‚úÖ Links saved in database
- ‚úÖ Shows to user and admin
- ‚ùå No automatic emails
- ‚ùå Manual calendar addition

---

## üîí **Security Notes**

### **Service Account Key:**
- Keep JSON file secure
- Never commit to git (.env.local is ignored)
- Rotate keys periodically
- Use environment variables on hosting

### **Calendar Permissions:**
- Service account only has access to shared calendar
- Cannot see personal events
- Only creates events you authorize

---

## üß™ **Testing**

### **1. Test Without API Setup (Fallback):**
- System generates: `meet.google.com/abc-defg-hij`
- User sees link
- No emails sent
- Works immediately

### **2. Test With API Setup (Full):**
- Real Meet link from Google
- Check your email for invitation
- Check Google Calendar for event
- Join meeting to test link

---

## üìä **What Gets Created**

**In Google Calendar:**
```
Event Title: Product Meeting - Company Name
Date: December 5, 2024
Time: 2:00 PM - 2:30 PM EST
Location: Google Meet link
Attendees: 
  - user@email.com (Customer)
  - sales@bulkleather.com (Admin)
Conference: Google Meet
Reminders: 1 day, 1 hour, 15 min before
```

**In Database:**
```javascript
{
  name: "John Doe",
  email: "john@company.com",
  date: "2024-12-05",
  timeSlot: "2:00 PM",
  meetingMode: "video",
  googleMeetLink: "https://meet.google.com/abc-defg-hij",
  googleCalendarEventId: "event123abc",
  status: "scheduled"
}
```

---

## üéä **Result**

Once set up:
1. User schedules meeting
2. Google Calendar event created automatically
3. Google sends emails to both user and admin
4. Meet link included
5. Both see event in their calendars
6. Reminders sent automatically
7. One-click join from calendar or email

**Completely automated!** üöÄ

---

## üìù **Quick Start**

**If you want automatic emails:**
1. Follow steps above (15 min setup)
2. Add service account credentials to .env.local
3. Share calendar with service account
4. Restart server
5. Test a meeting

**If you're okay with manual emails:**
1. Do nothing
2. System uses fallback
3. You get Meet links
4. Send emails manually

---

## üí° **Production Deployment**

Same credentials work in production:
- Add same environment variables to hosting platform
- Service account works globally
- No additional setup needed

---

**Choose your approach and I can help with either!** ‚ú®

